<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Профиль | Future Talk</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>FUTURE TALK</h1>
        <button class="burger" id="openMenu">☰</button>
    </header>
    <nav class="side-menu" id="sideMenu">
        <button class="close" id="closeMenu">×</button>
        <ul>
            <li id="goHome">Главная</li>
        </ul>
    </nav>
    <div class="overlay" id="overlay"></div>
    <div class="profile-container">
        <div class="profile-card">
            <div class="avatar-block">
                <img id="profileAvatar" class="profile-avatar" src="" alt="Аватарка">
                <label for="avatarInput" class="avatar-upload-btn">Изменить</label>
                <input type="file" id="avatarInput" accept="image/*" style="display:none">
            </div>
            <h2 id="profileLogin"></h2>
            <button class="profile-main-btn" id="profileMainBtn">Профиль</button>
            <div class="profile-info">
                <div><b>Email:</b> <span id="profileEmail"></span></div>
                <div><b>Пароль:</b> <span id="profilePassword">******</span> <button id="togglePassword" class="show-btn">Показать</button></div>
            </div>
            <button id="logoutBtn" class="logout-btn">Выйти</button>
        </div>
    </div>
    <script src="script.js"></script>
    <script>
    // --- профиль ---
    const username = localStorage.getItem('currentUser');
    if (!username) {
        window.location.href = 'login.html';
    } else {
        let users = JSON.parse(localStorage.getItem('users') || '{}');
        let user = users[username];
        document.getElementById('profileLogin').textContent = username;
        document.getElementById('profileEmail').textContent = user.email;
        let passwordShown = false;
        const pwSpan = document.getElementById('profilePassword');
        document.getElementById('togglePassword').onclick = function() {
            passwordShown = !passwordShown;
            pwSpan.textContent = passwordShown ? user.password : '******';
            this.textContent = passwordShown ? 'Скрыть' : 'Показать';
        };
        document.getElementById('logoutBtn').onclick = function() {
            localStorage.removeItem('currentUser');
            localStorage.removeItem('lastActive');
            window.location.href = 'login.html';
        };
        // Аватарка
        const avatarImg = document.getElementById('profileAvatar');
        const avatarInput = document.getElementById('avatarInput');
        function setAvatar(src) {
            avatarImg.src = src || 'https://ui-avatars.com/api/?name=' + encodeURIComponent(username) + '&background=6cf&color=181830&rounded=true&size=128';
        }
        setAvatar(user.avatar);
        avatarInput.onchange = function(e) {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(evt) {
                user.avatar = evt.target.result;
                users[username] = user;
                localStorage.setItem('users', JSON.stringify(users));
                setAvatar(user.avatar);
            };
            reader.readAsDataURL(file);
        };
        // Кнопка "Профиль"
        document.getElementById('profileMainBtn').onclick = function() {
            window.location.href = 'profile.html';
        };
    }
    // --- бургер-меню ---
    document.getElementById('openMenu').onclick = function() {
        document.getElementById('sideMenu').classList.add('open');
        document.getElementById('overlay').classList.add('active');
    };
    document.getElementById('closeMenu').onclick = closeMenu;
    document.getElementById('overlay').onclick = closeMenu;
    function closeMenu() {
        document.getElementById('sideMenu').classList.remove('open');
        document.getElementById('overlay').classList.remove('active');
    }
    // --- переход на главную ---
    document.getElementById('goHome').onclick = function() {
        window.location.href = 'index.html';
    };
    // --- авто-выход через 24ч ---
    function updateLastActive() {
        localStorage.setItem('lastActive', Date.now());
    }
    updateLastActive();
    document.body.addEventListener('click', updateLastActive);
    document.body.addEventListener('keydown', updateLastActive);
    // Проверка при загрузке
    const lastActive = localStorage.getItem('lastActive');
    if (lastActive && Date.now() - Number(lastActive) > 24*60*60*1000) {
        localStorage.removeItem('currentUser');
        localStorage.removeItem('lastActive');
        window.location.href = 'login.html';
    }
    </script>
</body>
</html> 